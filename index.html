<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Math Explorer ‚Äì Class 4</title>

<style>
body{
  font-family: system-ui, -apple-system, "Segoe UI", Roboto, Arial, sans-serif;
  background: linear-gradient(135deg,#fdfbfb,#ebedee);
  margin:0; padding:10px;
  text-align:center;
}

.card{
  background:#fff;
  max-width:420px;
  margin:auto;
  padding:16px;
  border-radius:16px;
  box-shadow:0 6px 14px rgba(0,0,0,.15);
}

h1{margin:6px;font-size:30px;}

button{
  font-size:18px;
  padding:10px 14px;
  margin:5px;
  border:none;
  border-radius:12px;
  background:#4a90e2;
  color:#fff;
}

button.secondary{background:#777;}
button.nav{background:#ffb300;color:#000;}
button.jump{font-size:15px;padding:6px 10px;margin:3px;}
button.selected{background:#2ecc71;}

.options button{width:90%;}

.question{
  font-size:22px;
  margin:12px 0;
}

.visual{
  font-size:44px;
  margin:8px;
}

#jumpNav{margin-top:10px;}

.review-card{
  background:#fff;
  border-radius:12px;
  padding:12px;
  margin:10px auto;
  max-width:420px;
  box-shadow:0 4px 10px rgba(0,0,0,.1);
  text-align:left;
}

footer{font-size:14px;color:#666;margin-top:10px;}
</style>
</head>

<body>

<h1>üìò Math Explorer</h1>

<!-- NAME SCREEN -->
<div id="nameScreen" class="card">
  <p>Enter your name</p>
  <input id="nameInput"
         style="font-size:18px;padding:8px;width:85%;text-align:center;border-radius:10px;">
  <br><br>
  <button onclick="startGame()">Start</button>
</div>

<!-- GAME SCREEN -->
<div id="gameScreen" class="card" style="display:none;">
  <div id="progress"></div>
  <div id="questionArea"></div>
  <div class="options" id="options"></div>

  <div>
    <button class="nav" onclick="prevQ()">‚¨Ö Prev</button>
    <button class="nav" onclick="nextQ()">Next ‚û°</button>
  </div>

  <div id="jumpNav"></div>

  <br>
  <button class="secondary" onclick="openReview()">Review Answers</button>
</div>

<!-- REVIEW SCREEN -->
<div id="reviewScreen" style="display:none;">
  <h2>üìù Review</h2>
  <div id="reviewArea"></div>

  <button class="secondary" onclick="backToGame()">‚¨Ö Edit Answers</button>
  <button onclick="submitFinal()">‚úÖ Submit</button>
</div>

<!-- RESULT SCREEN -->
<div id="resultScreen" class="card" style="display:none;">
  <h2>üéâ Result</h2>
  <p id="scoreText"></p>
  <button onclick="location.reload()">üîÑ Replay</button>
</div>

<footer>An MPPS Pedduru Initiative</footer>

<script>
/* ---------- UTILITIES ---------- */
function rand(min,max){
  return Math.floor(Math.random()*(max-min+1))+min;
}
function shuffle(arr){
  return arr.sort(()=>Math.random()-0.5);
}

/* ---------- QUESTION GENERATORS ---------- */
function genAddition(){
  let a=rand(100,500), b=rand(10,200);
  let ans=a+b;
  return {q:`${a} + ${b} = ?`, ans,
    opts:shuffle([ans,ans+10,ans-10]), vis:"‚ûï"};
}

function genSubtraction(){
  let a=rand(300,700), b=rand(50,250);
  let ans=a-b;
  return {q:`${a} ‚àí ${b} = ?`, ans,
    opts:shuffle([ans,ans+10,ans-10]), vis:"‚ûñ"};
}

function genMultiplication(){
  let a=rand(4,9), b=rand(6,12);
  let ans=a*b;
  return {q:`${a} √ó ${b} = ?`, ans,
    opts:shuffle([ans,ans+4,ans-4]), vis:"‚úñÔ∏è"};
}

function genDivision(){
  let b=rand(3,9), ans=rand(4,12);
  let a=b*ans;
  return {q:`${a} √∑ ${b} = ?`, ans,
    opts:shuffle([ans,ans+1,ans-1]), vis:"‚ûó"};
}

function genApples(){
  let a=rand(3,7), b=rand(2,6);
  let ans=a+b;
  return {q:`${a} apples + ${b} apples.<br>How many apples?`,
    ans, opts:shuffle([ans,ans+1,ans-1]), vis:"üçé"};
}

function genCandies(){
  let kids=[2,3,4][rand(0,2)];
  let ans=rand(3,8);
  let total=kids*ans;
  return {q:`${total} candies shared by ${kids} children.<br>Each gets?`,
    ans, opts:shuffle([ans,ans+1,ans-1]), vis:"üç¨"};
}

function genBikes(){
  let bikes=rand(3,8);
  let ans=bikes*2;
  return {q:`${bikes} bicycles have how many wheels?`,
    ans, opts:shuffle([ans,ans+2,ans-2]), vis:"üö≤"};
}

/* ---------- BUILD QUESTIONS ---------- */
const generators=[
  genAddition,genSubtraction,genMultiplication,
  genDivision,genApples,genCandies,genBikes
];

const TOTAL=15;
const questions=[];
for(let i=0;i<TOTAL;i++){
  const g=generators[rand(0,generators.length-1)];
  questions.push(g());
}

const answers=new Array(TOTAL).fill(null);
let current=0;
let name="";

/* ---------- GAME LOGIC ---------- */
function startGame(){
  name=document.getElementById("nameInput").value||"Student";
  document.getElementById("nameScreen").style.display="none";
  document.getElementById("gameScreen").style.display="block";
  buildJumpNav();
  loadQ();
}

function loadQ(){
  document.getElementById("progress").innerHTML=
    `Question ${current+1} of ${TOTAL}`;

  const q=questions[current];
  document.getElementById("questionArea").innerHTML=
    `<div class="visual">${q.vis}</div>
     <div class="question">${q.q}</div>`;

  const optDiv=document.getElementById("options");
  optDiv.innerHTML="";
  q.opts.forEach(v=>{
    const b=document.createElement("button");
    b.innerHTML=v;
    if(answers[current]===v) b.classList.add("selected");
    b.onclick=()=>{answers[current]=v; loadQ();};
    optDiv.appendChild(b);
  });

  updateJumpNav();
}

function nextQ(){ if(current<TOTAL-1){current++; loadQ();} }
function prevQ(){ if(current>0){current--; loadQ();} }

function buildJumpNav(){
  const j=document.getElementById("jumpNav");
  j.innerHTML="";
  for(let i=0;i<TOTAL;i++){
    const b=document.createElement("button");
    b.className="jump";
    b.innerText=i+1;
    b.onclick=()=>{current=i; loadQ();};
    j.appendChild(b);
  }
}

function updateJumpNav(){
  document.querySelectorAll(".jump").forEach((b,i)=>{
    b.style.background=answers[i]!=null?"#2ecc71":"#ccc";
    b.style.color="#000";
  });
}

/* ---------- REVIEW & SUBMIT ---------- */
function openReview(){
  document.getElementById("gameScreen").style.display="none";
  document.getElementById("reviewScreen").style.display="block";

  let html="";
  questions.forEach((q,i)=>{
    html+=`
      <div class="review-card">
        <b>Q${i+1}.</b> ${q.q}<br>
        <i>Your answer:</i> ${answers[i] ?? "Not answered"}
      </div>`;
  });
  document.getElementById("reviewArea").innerHTML=html;
}

function backToGame(){
  document.getElementById("reviewScreen").style.display="none";
  document.getElementById("gameScreen").style.display="block";
}

function submitFinal(){
  let score=0;
  questions.forEach((q,i)=>{
    if(answers[i]===q.ans) score++;
  });

  document.getElementById("reviewScreen").style.display="none";
  document.getElementById("resultScreen").style.display="block";
  document.getElementById("scoreText").innerHTML=
    `${name}, you scored <b>${score} / ${TOTAL}</b>`;
}
</script>

</body>
</html>